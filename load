#!/usr/bin/env python3

## Build the comic files
print("Building comic.")
import os, json
directory=os.listdir("webcomic")
file=open("config.js","r")
data=json.load(file)

## Load a bunch of data to index.html
cmlist=""""""
for x in data["comics"]:
    cmlist+="""
<div id="comic-ref">
    """+x[0]+"""
</div>
    """
index="""
<!DOCTYPE html>
<html>
    <head>
      <link rel="stylesheet" href="main.css">
      <title>LinuxRocks2000 - A webcomic</title>
    </head>
    <body>
      <script src="header.js"></script>
      <div id="comiclist">
        <div id="comic-ref">
          """+cmlist+"""
        </div>
      </div>
    </body>
</html>
"""
c=open("index.html","w+")
c.write(index)
c.close
file.close()

## Push git
import git
print("Pushing git")
repo=git.Repo(r"/home/awesome/desk/programs/web-based/github-pages/LinuxRocks2000.github.io")
try:
    repo.git.add(A=True)
    repo.index.commit("Updating my webcomic from an automated build helper I scripted in python")
    origin=repo.remote(name="origin")
    origin.push()
except git.GitCommandError as G:
    print("Invalid password. Please try again.")
    try:
        origin=repo.remote(name="origin")
        origin.push()
    except git.GitCommandError as G:
        print("Two strikes... YOUR OUT")
