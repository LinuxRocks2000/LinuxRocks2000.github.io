
<!DOCTYPE html>
<html>
    <head>
    </head>
    <body>
      <style type="text/css">
        #image {
          pointer-events:none;
          width:100%;
          height:100%;
        }
        #ilink {
          display:block;
        }
        #floating_wrapper{
          min-width:100%;
          text-align:center;
        }
        .navbuttons {
          padding:10px;
          background-color:lightgray;
          margin:10px;
          color: black;
        }
        .navbuttons:hover{
          padding:15px;
          margin:5px;
          color:blue;
        }
        .navbuttons_wrapper{
          overflow:scroll;
        }
        #comments-wrapper{
          display: inline-block;
          margin:20px;
        }
        .comment{
          border-radius:10px 10px;
          border:10px solid lightblue;
          text-align:left;
        }
        .publishedby{
          margin:20px;
          border-bottom:1px solid blue;
        }
        .bodytext{
          margin:20px;
        }
      </style>
      <script type="text/javascript" src="comiclist.js"></script>
      <script type="text/javascript" src="https://npmcdn.com/parse/dist/parse.min.js"></script>
      <script>
        Parse.serverURL = 'https://parseapi.back4app.com'; // This is your Server URL
        Parse.initialize(
          '9xjMXioZPbkyAxbJWSG4VpFN2orZ1taMj0kYKVUc', // This is your Application ID
          '1OpAAKiJumZGibsjQ5eX8g0EkNAKr3cD35XiX3AJ' // This is your Javascript key
        );
        const Comment=Parse.Object.extend("Comment");
      </script>
      <div id="floating_wrapper">
      <div class="comic_wrapper">
        <h1 id="title"></h1>
        <p id="date" class="date"></p>
        <a target="_blank" id="ilink">
          <object type="image/svg+xml" id="image"></object>
        </a>
        <h3 id="belowtext"></h3>
      </div>
        <div id="navbuttons_wrapper">
        <a id="fastbackward" data-hash="#1" onclick="reset('fastbackward');" class="navbuttons">|&lt;</a>
        <a id="last" class="navbuttons" onclick="reset('last');">&lt;</a>
        <a id="reload" class="navbuttons" onclick="reset();">Reload</a>
        <a id="next" class="navbuttons" onclick="reset('next');">&gt;</a>
        <a id="fastforward" class="navbuttons" onclick="reset('fastforward');">&gt;|</a>
        </div>
        <a href="https://play.google.com/store/apps/details?id=io.github.linuxrocks2000.swirlytrailsapp" style="display:inline-block; border:solid 5px lightblue; margin:10px; width:50%;">
        <object type="image/svg+xml" data="swirly_featureimage.svg" style="pointer-events:none;" width="100%"></object>
        (Click Here)
        </a>
        <H2>Comments are here! They are not entirely ready for use yet, but if you have a comment you want to post please do.</H2>
        <div id="comment-post-wrapper">
          Username: <input type="text" id="username"><br>
          Body: <input type="text" id="body"><br>
          <button onclick="loaduser()">Submit</button>
        </div>
        <div id="comments-wrapper">
        </div>
      </div>
      <!--H your Taml-->
      <script type="text/javascript">
        var chash;
        var cnum;
        function setCookie(cname, cvalue, exdays) {
          var d = new Date();
          d.setTime(d.getTime() + (exdays*24*60*60*1000));
          var expires = "expires="+ d.toUTCString();
          document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
        }
          function readcookie(cookie){
              var retval={};
              cookie=decodeURIComponent(cookie);
              dlist=(document.cookie) ? cookie.split("; ") : [];
              for (var i=0; i<dlist.length; i++){
                  var indx=dlist[i].indexOf("=");
                  retval[dlist[i].substring(0,indx)]=dlist[i].substring(indx+1);
              }
              return retval;
          }
        function loadcomments(){
          document.getElementById("username").value=document.cookie;
          document.getElementById("body").value="";
          document.getElementById("comments-wrapper").innerHTML="";
          var query=new Parse.Query(Comment);
          query.equalTo("comic",cnum)
          query.find().then((results) => {
            for (var s=results.length-1; s>=0; s--){
            console.log("wheres the error? THERE HE IS");
            var d=document.createElement("div");
            d.className="comment";
            document.getElementById("comments-wrapper").appendChild(d);
            var t=document.createElement("p");
            t.className="publishedby";
            t.innerText=results[s].get("user");
            d.appendChild(t);
            var b=document.createElement("p");
            b.className="bodytext";
            b.innerText=results[s].get("body");
            d.appendChild(b);
          }},(error)=>{});
        }
        function loaduser(){
          var data=new Comment();
          data.save({user:document.getElementById("username").value,body:document.getElementById("body").value,comic:cnum}).then(function(response) {loadcomments()}).catch(function(error) {});
        }
        function reset(by){
          document.getElementById("comments-wrapper").innerHTML="";
          scroll(0,0)
          if (by){
            location.hash=document.getElementById(by).getAttribute("data-hash");
          }
          chash=location.hash || "#"+comics.length;
          cnum=parseInt(chash.substring(1));
          console.log(by);
          console.log(chash);
          console.log(cnum);
          document.getElementById("image").data='webcomic/'+(comics[cnum-1][1]);
          document.getElementById("title").innerHTML=comics[cnum-1][0];
          document.getElementById("date").innerHTML=comics[cnum-1][2];
          document.getElementById("belowtext").innerHTML=comics[cnum-1][3];
          document.getElementById('ilink').href="webcomic/"+comics[cnum-1][1];
          if (cnum>1){
            document.getElementById("last").style.display="inline";
            document.getElementById("fastbackward").style.display="inline";
            document.getElementById("last").setAttribute("data-hash","#"+(cnum-1));
          }
          else{
            document.getElementById("last").style.display="none";
            document.getElementById("fastbackward").style.display="none";
          }
          if (cnum<comics.length){
            document.getElementById("next").style.display="inline";
            document.getElementById("fastforward").style.display="inline";
            document.getElementById("next").setAttribute("data-hash","#"+(cnum+1));
            document.getElementById("fastforward").setAttribute("data-hash","#"+comics.length);
          }
          else {
            document.getElementById("next").style.display="none";
            document.getElementById("fastforward").style.display="none";
          }
          loadcomments();
        }
        if (location.hash==""){
          location.hash="#"+comics.length;
        }
        reset();
        // Created element. Now finish building To-Do list.
      </script>
    </body>
</html>
